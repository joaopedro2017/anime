<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Anime</title>
	<style>
		body{
			width: 500px;
			margin: auto;
			text-align: center;
		}
	</style>
	
</head>
<body>
	<h1>Animação Básica - Ciclo de Animaçao Basico</h1>
	<div>Lugar para animação</div>
	<canvas></canvas>
	<script>
		var eCanvas = document.getElementsByTagName("canvas")[0];
		var ctx = eCanvas.getContext("2d");

		var x = 10, vx = 0;
		var y = 20, vy = 0;
		var vm = 150;

		var antes = new Date();
		var agora = new Date();

		var dt = 0;
		var fps = 0;

		requestAnimationFrame(passo);

		function passo(){
		requestAnimationFrame(passo);
		agora = new Date();
		dt = (agora - antes)/1000;

		//manipulação da div
		/*eDiv.innerText = "p: " + p;
		eDiv.innerText += " antes: " + antes;
		eDiv.innerText += " agora: " + agora;
		eDiv.innerText += " dt(s): " + dt/1000 + "s";
		eDiv.innerText += " fps: " + 1000/dt;*/
		//final

		ctx.clearRect(0,0, eCanvas.width, eCanvas.height);

		ctx.strokeText("fps: " + Math.floor(1/dt) , 10 ,20); //desenha texto
		x = x + vx *dt;
		y = y + vy *dt;
		ctx.fillRect(x , y , 10 ,10); //desenha um quadrado		
		antes = agora;
	}

	addEventListener("keydown", teclaPressionada);

	function teclaPressionada(evento){
		console.log(evento.keyCode);
		switch(evento.keyCode){
			case 37:
				vx = -vm;
				break;
			case 39:
				vx = +vm;
				break;
			case 38:
				vy = -vm;
				break;
			case 40:
				vy = +vm;
				break;
			default:
			vx = 0;
			vy = 0;
		}
	}
	</script>
</body>
</html>